# NeoVM / Neomacs Plan

Last updated: 2026-02-15

## Done

- Implemented `default-file-modes` / `set-default-file-modes` compatibility slice:
  - added builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_default_file_modes`
    - `builtin_set_default_file_modes`
  - semantics aligned with oracle subset:
    - `default-file-modes` arity `0`, return integer mode bits
    - `set-default-file-modes` arity `1`, strict integer validation, return `nil`
    - round-trip default mode updates preserved
  - registered and dispatched both builtins in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/default-file-modes-semantics.forms`
    - `test/neovm/vm-compat/cases/default-file-modes-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml default_file_modes -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/default-file-modes-semantics.forms EXPECTED=cases/default-file-modes-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `set-file-times` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_set_file_times`
    - `builtin_set_file_times_eval`
  - semantics aligned with oracle subset:
    - arity `1..3`
    - strict `stringp` validation for `FILENAME`
    - `TIMESTAMP=nil` uses current time
    - numeric and list timestamp forms accepted for deterministic epoch writes
    - non-`nil` `FLAG` treated like `nofollow` (matching current Emacs behavior)
    - return shape `t` on success
    - evaluator path resolves relative names against dynamic/default `default-directory`
  - registered and dispatched `set-file-times` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/set-file-times-semantics.forms`
    - `test/neovm/vm-compat/cases/set-file-times-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml set_file_times -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/set-file-times-semantics.forms EXPECTED=cases/set-file-times-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `file-newer-than-file-p` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_file_newer_than_file_p`
    - `builtin_file_newer_than_file_p_eval`
  - semantics aligned with oracle subset:
    - arity `2`
    - strict `stringp` validation for `FILE1` and `FILE2`
    - missing `FILE1` returns `nil`
    - missing `FILE2` returns `t`
    - evaluator path resolves relative names against dynamic/default `default-directory`
  - registered and dispatched `file-newer-than-file-p` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/file-newer-than-file-p-semantics.forms`
    - `test/neovm/vm-compat/cases/file-newer-than-file-p-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml file_newer_than_file_p -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/file-newer-than-file-p-semantics.forms EXPECTED=cases/file-newer-than-file-p-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `file-name-case-insensitive-p` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_file_name_case_insensitive_p`
    - `builtin_file_name_case_insensitive_p_eval`
  - semantics aligned with oracle subset:
    - arity `1`
    - strict `stringp` validation for `FILENAME`
    - evaluator path resolves relative names against dynamic/default `default-directory`
    - current backend reports case-insensitive filesystem truthiness per-platform with existing-path ancestry probing
  - registered and dispatched `file-name-case-insensitive-p` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/file-name-case-insensitive-p-semantics.forms`
    - `test/neovm/vm-compat/cases/file-name-case-insensitive-p-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml file_name_case_insensitive -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/file-name-case-insensitive-p-semantics.forms EXPECTED=cases/file-name-case-insensitive-p-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `set-file-modes` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_set_file_modes`
    - `builtin_set_file_modes_eval`
  - semantics aligned with oracle subset:
    - arity `2..3`
    - strict `stringp` validation for `FILENAME`
    - strict `fixnump` validation for `MODE`
    - optional `FLAG` accepted and ignored
    - success return shape `nil`
    - evaluator path resolves relative names against dynamic/default `default-directory`
    - Unix chmod failures map to specific file conditions with Emacs-style `"Doing chmod"` payload prefix
  - registered and dispatched `set-file-modes` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/set-file-modes-semantics.forms`
    - `test/neovm/vm-compat/cases/set-file-modes-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml set_file_modes -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/set-file-modes-semantics.forms EXPECTED=cases/set-file-modes-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `file-modes` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_file_modes`
    - `builtin_file_modes_eval`
  - semantics aligned with oracle subset:
    - arity `1..2`
    - strict `stringp` validation for `FILENAME`
    - missing/unreadable paths return `nil`
    - Unix mode return value normalized to permission bits (`mode & 07777`)
    - evaluator path resolves relative names against dynamic/default `default-directory`
  - registered and dispatched `file-modes` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/file-modes-semantics.forms`
    - `test/neovm/vm-compat/cases/file-modes-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml file_modes -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/file-modes-semantics.forms EXPECTED=cases/file-modes-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `make-nearby-temp-file` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_make_nearby_temp_file`
    - `builtin_make_nearby_temp_file_eval`
  - semantics aligned with oracle subset:
    - arity `1..3`
    - `PREFIX`/`SUFFIX` type validation payloads (`sequencep` vs `stringp`) aligned with `make-temp-file`
    - plain prefixes allocate under `temporary-file-directory` fallback
    - directory-containing prefixes allocate nearby using basename-only temp prefixing
    - evaluator path resolves relative directory-containing prefixes against dynamic/default `default-directory`
  - registered and dispatched `make-nearby-temp-file` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/make-nearby-temp-file-semantics.forms`
    - `test/neovm/vm-compat/cases/make-nearby-temp-file-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml make_nearby_temp_file -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/make-nearby-temp-file-semantics.forms EXPECTED=cases/make-nearby-temp-file-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `delete-file` optional `TRASH` compatibility slice:
  - extended `delete-file` arity in `rust/neovm-core/src/elisp/fileio.rs` from exact 1 to `1..2` for both pure and evaluator-aware paths
  - preserved strict `stringp` validation for `FILENAME`
  - kept missing-file behavior as successful no-op (existing compat behavior)
  - added unit coverage for optional arg acceptance and `wrong-number-of-arguments` at 3 args
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/delete-file-trash-semantics.forms`
    - `test/neovm/vm-compat/cases/delete-file-trash-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml delete_file -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/delete-file-trash-semantics.forms EXPECTED=cases/delete-file-trash-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `make-symbolic-link` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_make_symbolic_link`
    - `builtin_make_symbolic_link_eval`
  - semantics aligned with oracle subset on Unix:
    - arity `2..3`
    - `stringp` validation for `TARGET` and `LINKNAME`
    - optional `OK-IF-ALREADY-EXISTS` support by replacing existing linkname
    - relative path resolution against eval-time `default-directory` in evaluator path
  - registered and dispatched `make-symbolic-link` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/make-symbolic-link-semantics.forms`
    - `test/neovm/vm-compat/cases/make-symbolic-link-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml make_symbolic_link -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/make-symbolic-link-semantics.forms EXPECTED=cases/make-symbolic-link-semantics.expected.tsv` (pass, 7/7)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `delete-directory` compatibility slice:
  - added pure + evaluator-aware builtins in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_delete_directory`
    - `builtin_delete_directory_eval`
  - semantics aligned with oracle subset:
    - arity `1..3`
    - `stringp` validation for `DIRECTORY`
    - recursive behavior via optional `RECURSIVE` arg (`remove_dir_all` vs `remove_dir`)
    - relative path resolution against eval-time `default-directory`
  - registered and dispatched `delete-directory` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/delete-directory-semantics.forms`
    - `test/neovm/vm-compat/cases/delete-directory-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml delete_directory -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/delete-directory-semantics.forms EXPECTED=cases/delete-directory-semantics.expected.tsv` (pass, 6/6)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `make-temp-file` compatibility slice:
  - added pure + evaluator-aware implementations in `rust/neovm-core/src/elisp/fileio.rs`:
    - `builtin_make_temp_file`
    - `builtin_make_temp_file_eval`
  - semantics aligned with oracle subset:
    - arity `1..4`
    - `PREFIX` type payloads distinguish `sequencep` vs `stringp` mismatch classes
    - `SUFFIX` validates `stringp` when non-nil
    - non-string `TEXT` arguments are ignored (oracle behavior)
    - supports `DIR-FLAG` directory creation
    - evaluator path honors dynamic `temporary-file-directory`
  - registered and dispatched `make-temp-file` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/make-temp-file-semantics.forms`
    - `test/neovm/vm-compat/cases/make-temp-file-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml make_temp_file -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/make-temp-file-semantics.forms EXPECTED=cases/make-temp-file-semantics.expected.tsv` (pass, 8/8)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `file-truename` compatibility slice:
  - added path-level `file_truename` resolution in `rust/neovm-core/src/elisp/fileio.rs`:
    - expands relative paths against default directory
    - canonicalizes existing path prefixes while preserving missing suffixes
    - preserves trailing slash directory marker semantics
  - added pure + evaluator-aware builtins:
    - `builtin_file_truename`
    - `builtin_file_truename_eval`
  - aligned internal argument semantics:
    - arity `1..3`
    - `stringp` validation for `FILENAME`
    - `COUNTER` list-shape validation (`listp`)
    - first counter element `number-or-marker-p` validation (oracle-compatible error payload)
  - registered and dispatched `file-truename` in:
    - `rust/neovm-core/src/elisp/builtins.rs`
    - `rust/neovm-core/src/elisp/builtin_registry.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/file-truename-semantics.forms`
    - `test/neovm/vm-compat/cases/file-truename-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml file_truename -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/file-truename-semantics.forms EXPECTED=cases/file-truename-semantics.expected.tsv` (pass, 8/8)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `get-file-buffer` compatibility slice:
  - added evaluator-backed dispatch in `rust/neovm-core/src/elisp/builtins.rs` with Emacs-style semantics:
    - arity `1`
    - `stringp` validation payloads for non-string arguments
    - resolves lookup candidates relative to eval-time `default-directory`
    - matches visited file buffers by exact resolved path and canonicalized path fallback
  - added builtin registration in `rust/neovm-core/src/elisp/builtin_registry.rs`
  - expanded `builtins.rs` unit coverage for:
    - exact, relative, and canonicalized match paths
    - missing-path nil return
    - non-string type error path
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/get-file-buffer-semantics.forms`
    - `test/neovm/vm-compat/cases/get-file-buffer-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml get_file_buffer -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/get-file-buffer-semantics.forms EXPECTED=cases/get-file-buffer-semantics.expected.tsv` (pass, 4/4)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `buffer-local-variables` compatibility slice (custom/buffer-local system):
  - aligned evaluator dispatch target in `rust/neovm-core/src/elisp/custom.rs` from loose fallback behavior to explicit argument/arity semantics:
    - arity `0..1`
    - non-`nil` non-buffer argument now signals `wrong-type-argument` with `bufferp`
    - `BUFFER=nil`/omitted uses current buffer
  - implemented deterministic explicit-local alist return from buffer-local storage:
    - entries emitted as `(SYMBOL . VALUE)`
    - sorted by symbol name for stable output
  - expanded `custom.rs` tests for:
    - empty-buffer return shape (`nil`)
    - argument validation payloads (type and arity)
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/buffer-local-variables-semantics.forms`
    - `test/neovm/vm-compat/cases/buffer-local-variables-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml buffer_local_variables -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/buffer-local-variables-semantics.forms EXPECTED=cases/buffer-local-variables-semantics.expected.tsv` (pass, 7/7)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `symbol-file` compatibility slice (stub -> evaluator-backed subset):
  - added evaluator-aware dispatch in `rust/neovm-core/src/elisp/builtins.rs` for `symbol-file`
  - implemented `builtin_symbol_file_eval` in `rust/neovm-core/src/elisp/autoload.rs`:
    - supports arity `1..3` (and `wrong-number-of-arguments` at 0 or 4+)
    - returns `nil` for non-symbol designators
    - resolves autoloaded function origin file for default / `TYPE=nil` / `TYPE='defun`
    - returns `nil` for other `TYPE` selectors
  - added/expanded unit tests in `autoload.rs` for:
    - autoload file return path
    - type gating
    - third-arg acceptance and four-arg error
    - non-symbol behavior
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/symbol-file-semantics.forms`
    - `test/neovm/vm-compat/cases/symbol-file-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
    - wired into `test/neovm/vm-compat/cases/introspection.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml symbol_file -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/symbol-file-semantics.forms EXPECTED=cases/symbol-file-semantics.expected.tsv` (pass, 16/16)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Expanded legacy bytecode vm-compat corpus for `.elc` literal execution edges:
  - added:
    - `test/neovm/vm-compat/cases/bytecode-literal-edge-opcodes-semantics.forms`
    - `test/neovm/vm-compat/cases/bytecode-literal-edge-opcodes-semantics.expected.tsv`
  - enabled in:
    - `test/neovm/vm-compat/cases/legacy-elc-literal.list`
  - locked parity for edge opcodes:
    - `varbind` / `unbind`
    - `stack-ref` narrow/wide paths
    - wide operand bind/unbind path
  - verified:
    - `NEOVM_WORKER_CARGO_FEATURES=legacy-elc-literal make -C test/neovm/vm-compat check-neovm FORMS=cases/bytecode-literal-edge-opcodes-semantics.forms EXPECTED=cases/bytecode-literal-edge-opcodes-semantics.expected.tsv` (pass, 5/5)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `where-is-internal` compatibility slice (stub -> evaluator-backed):
  - implemented in `rust/neovm-core/src/elisp/interactive.rs`:
    - arity validation (`1..5`)
    - keymap designator validation with `wrong-type-argument keymapp ...`
    - explicit/default global-map resolution
    - prefix-map and parent-map traversal
    - `FIRSTONLY` return-shape semantics (vector vs list of vectors)
    - `nil` when no binding matches
  - added unit coverage in `interactive.rs` for:
    - explicit keymap match
    - `FIRSTONLY` vector shape
    - keymap type error payload
    - non-definition no-match path
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/where-is-internal-semantics.forms`
    - `test/neovm/vm-compat/cases/where-is-internal-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml where_is_internal -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/where-is-internal-semantics.forms EXPECTED=cases/where-is-internal-semantics.expected.tsv` (pass, 6/6)
    - targeted list gate:
      - `NEOVM_WORKER_CARGO_FEATURES=legacy-elc-literal make -C test/neovm/vm-compat check-neovm-list LIST=/tmp/neovm-targeted.list` (pass)
- Aligned region-taking case builtins with Emacs character-position semantics and optional noncontiguous behavior:
  - switched `kill-region`, `kill-ring-save`, `copy-region-as-kill`, `downcase-region`, `upcase-region`, `capitalize-region`, `upcase-initials-region`, and `indent-rigidly` shared bounds resolution to Emacs-style 1-based character positions
  - `interactive` default region argument synthesis now passes 1-based character positions (not raw byte offsets)
  - updated `upcase-region` / `downcase-region` / `capitalize-region` arity to `2..3` and aligned `REGION-NONCONTIGUOUS-P` behavior:
    - non-nil arg requires a live mark
    - non-nil arg uses active point/mark region (ignores explicit `BEG`/`END`)
  - updated affected `kill_ring` unit tests to use character positions and added coverage for noncontiguous-mark behavior
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/case-region-optional-arg-semantics.forms`
    - `test/neovm/vm-compat/cases/case-region-optional-arg-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test kill_ring::tests:: -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/case-region-optional-arg-semantics.forms EXPECTED=cases/case-region-optional-arg-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/command-dispatch-default-arg-semantics.forms EXPECTED=cases/command-dispatch-default-arg-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `backtrace-frame` compatibility slice:
  - replaced misc stub with evaluator-backed compatibility behavior:
    - enforces `wholenump` argument validation and 1..=2 arity
    - supports optional `BASE` filtering (`BASE` non-nil returns `nil`)
    - returns deterministic list-shaped frames for low indices and `nil` for deep indices
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/backtrace-frame-semantics.forms`
    - `test/neovm/vm-compat/cases/backtrace-frame-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - expanded `rust/neovm-core/src/elisp/misc.rs` unit coverage for:
    - low-frame shape behavior
    - `BASE` semantics
    - arity and `wholenump` error payloads
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml backtrace_frame -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/backtrace-frame-semantics.forms EXPECTED=cases/backtrace-frame-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `system-users` / `system-groups` compatibility slice:
  - replaced dired stubs with real account/group discovery from `/etc/passwd` and `/etc/group`
  - aligned output ordering with oracle behavior (reverse file order)
  - preserved fallback behavior when account files are unavailable
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/system-users-groups-semantics.forms`
    - `test/neovm/vm-compat/cases/system-users-groups-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - expanded `rust/neovm-core/src/elisp/dired.rs` tests for parsed ordering and list shape
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml dired::tests::test_system_ -- --nocapture` (pass)
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml parse_colon_file_names_reverses_order -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/system-users-groups-semantics.forms EXPECTED=cases/system-users-groups-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `read-coding-system` compatibility slice:
  - replaced `read-coding-system` / `read-non-nil-coding-system` UTF-8 stubs with batch-compatible prompt behavior:
    - prompt argument now validates as `stringp`
    - arity now matches oracle payloads
    - batch path now signals `(end-of-file "Error reading from stdin")`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/read-coding-system-semantics.forms`
    - `test/neovm/vm-compat/cases/read-coding-system-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - expanded `rust/neovm-core/src/elisp/lread.rs` unit coverage for EOF/type/arity paths
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml lread::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/read-coding-system-semantics.forms EXPECTED=cases/read-coding-system-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `eval-buffer` / `eval-region` compatibility slice:
  - replaced `lread` stubs with real evaluator-backed behavior:
    - `eval-buffer` now resolves source buffer (`nil`/current, buffer object, buffer name), evaluates all parsed forms, and preserves Emacs-compatible return shape (`nil`)
    - `eval-region` now enforces Emacs-compatible arity/type/range payloads, supports `nil` bounds via current point, evaluates region forms, and preserves `nil` return shape
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/eval-buffer-region-semantics.forms`
    - `test/neovm/vm-compat/cases/eval-buffer-region-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - expanded `rust/neovm-core/src/elisp/lread.rs` unit coverage for:
    - successful evaluation paths
    - source-buffer designator semantics
    - no-op bounds and point stability
    - type/range/arity error payloads
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml lread::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/eval-buffer-region-semantics.forms EXPECTED=cases/eval-buffer-region-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `transient-mark-mode` compatibility slice:
  - aligned evaluator behavior with oracle semantics for:
    - optional-argument handling (`nil`/missing, numeric, non-numeric non-nil)
    - state publication to `transient-mark-mode`
    - over-arity signaling (`wrong-number-of-arguments`)
  - expanded unit coverage in `rust/neovm-core/src/elisp/navigation.rs`
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/transient-mark-mode-semantics.forms`
    - `test/neovm/vm-compat/cases/transient-mark-mode-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml navigation::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/transient-mark-mode-semantics.forms EXPECTED=cases/transient-mark-mode-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented display query selected-frame designator compatibility slice:
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/display-frame-designator-semantics.forms`
    - `test/neovm/vm-compat/cases/display-frame-designator-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - added evaluator-aware dispatch/validation for display query builtins:
    - `display-graphic-p`
    - `display-color-p`
    - `display-pixel-width`
    - `display-pixel-height`
    - `display-mm-width`
    - `display-mm-height`
    - `display-screens`
    - `display-color-cells`
    - `display-planes`
    - `display-visual-class`
    - `display-backing-store`
  - preserved monitor builtin behavior to avoid a real representation conflict:
    - NeoVM frame objects are currently integer IDs, so accepting live frame IDs in monitor APIs causes oracle drift for integer argument error paths (`display-monitor-semantics`)
    - monitor APIs remain on existing terminal-designator validation until frame object representation is decoupled from plain integers
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml display::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-frame-designator-semantics.forms EXPECTED=cases/display-frame-designator-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-query-designator-semantics.forms EXPECTED=cases/display-query-designator-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-monitor-semantics.forms EXPECTED=cases/display-monitor-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-monitor-frames-semantics.forms EXPECTED=cases/display-monitor-frames-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented display query designator compatibility slice:
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/display-query-designator-semantics.forms`
    - `test/neovm/vm-compat/cases/display-query-designator-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - aligned optional display designator semantics for:
    - `display-graphic-p`
    - `display-color-p`
    - `display-pixel-width`
    - `display-pixel-height`
    - `display-mm-width`
    - `display-mm-height`
    - `display-screens`
    - `display-color-cells`
    - `display-planes`
    - `display-visual-class`
    - `display-backing-store`
  - behavior now matches oracle in batch mode:
    - accepts `nil` and live terminal handle designators
    - signals `error` on invalid designators instead of silently returning defaults
  - verified:
    - `cargo test display::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-query-designator-semantics.forms EXPECTED=cases/display-query-designator-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-batch-semantics.forms EXPECTED=cases/display-batch-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-stub-semantics.forms EXPECTED=cases/display-stub-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/x-display-batch-semantics.forms EXPECTED=cases/x-display-batch-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented batch reader `end-of-file` payload compatibility slice:
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/read-batch-error-payloads.forms`
    - `test/neovm/vm-compat/cases/read-batch-error-payloads.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - aligned batch reader error payloads to GNU Emacs:
    - `read-from-minibuffer`
    - `read-string`
    - `read-number`
    - `completing-read`
    - `y-or-n-p`
    - `yes-or-no-p`
  - all now signal:
    - `(end-of-file "Error reading from stdin")`
  - verified:
    - `cargo test reader::tests:: -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/read-batch-error-payloads.forms EXPECTED=cases/read-batch-error-payloads.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/input-batch-readers.forms EXPECTED=cases/input-batch-readers.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/read-batch-input-semantics.forms EXPECTED=cases/read-batch-input-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `undo` result/payload compatibility slice:
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/undo-result-semantics.forms`
    - `test/neovm/vm-compat/cases/undo-result-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - fixed `undo-boundary` evaluator dispatch so boundaries are recorded in live buffer undo state
  - aligned grouped undo traversal with oracle for lists with/without trailing boundaries
  - aligned `undo` return/error payload behavior across:
    - `"Undo"`
    - `user-error "No further undo information"`
    - `user-error "No undo information in this buffer"`
  - verified:
    - `cargo test undo::tests:: -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/undo-result-semantics.forms EXPECTED=cases/undo-result-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/undo-basics.forms EXPECTED=cases/undo-basics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/undo-arity-semantics.forms EXPECTED=cases/undo-arity-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/undo-buffer-arg.forms EXPECTED=cases/undo-buffer-arg.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `undo` arity compatibility slice:
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/undo-arity-semantics.forms`
    - `test/neovm/vm-compat/cases/undo-arity-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - aligned `undo` to reject >1 args with `wrong-number-of-arguments`
  - updated undo unit coverage to assert multi-arg error semantics
  - verified:
    - `cargo test undo::tests:: -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/undo-arity-semantics.forms EXPECTED=cases/undo-arity-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Full vm-compat verification rerun after recent textprop/overlay slices:
  - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `remove-overlays` arity compatibility slice:
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/remove-overlays-arity-semantics.forms`
    - `test/neovm/vm-compat/cases/remove-overlays-arity-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - aligned `remove-overlays` to reject >4 args with `wrong-number-of-arguments`
  - added unit test for the over-arity path in `textprop.rs`
  - verified:
    - `cargo test remove_overlays_ -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/remove-overlays-arity-semantics.forms EXPECTED=cases/remove-overlays-arity-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented text-property arity compatibility slice:
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/textprop-arity-semantics.forms`
    - `test/neovm/vm-compat/cases/textprop-arity-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - aligned max-arity checks with GNU Emacs for:
    - `put-text-property` (max 5)
    - `get-text-property` / `get-char-property` (max 3)
    - `add-text-properties` / `remove-text-properties` (max 4)
    - `text-properties-at` (max 2)
    - `next-single-property-change` / `previous-single-property-change` (max 4)
    - `next-property-change` (max 3)
    - `text-property-any` (max 5)
  - added unit tests for over-arity error paths in `textprop.rs`
  - verified:
    - `cargo test textprop::tests:: -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/textprop-arity-semantics.forms EXPECTED=cases/textprop-arity-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented overlay arity compatibility slice:
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/overlay-arity-semantics.forms`
    - `test/neovm/vm-compat/cases/overlay-arity-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - aligned overlay builtins with GNU Emacs arity checks:
    - `make-overlay` now enforces max 5 args
    - `overlays-at` now enforces max 2 args
    - `move-overlay` now enforces max 4 args
  - added unit tests for over-arity paths in `textprop.rs`
  - verified:
    - `cargo test overlay_ -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/overlay-arity-semantics.forms EXPECTED=cases/overlay-arity-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented batch prompt-reader compatibility slice:
  - aligned `read-file-name` / `read-directory-name` with oracle:
    - `end-of-file` now includes payload `"Error reading from stdin"`
    - validates `DIR` / `DEFAULT` / `INITIAL` string designators when provided
  - aligned `read-buffer` / `read-command` / `read-variable` batch `end-of-file` payloads to oracle
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/read-batch-input-semantics.forms`
    - `test/neovm/vm-compat/cases/read-batch-input-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test builtin_read_file_name -- --nocapture` (pass)
    - `cargo test builtin_read_directory_name -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/read-batch-input-semantics.forms EXPECTED=cases/read-batch-input-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Full vm-compat verification rerun after latest minibuffer/search slices:
  - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `minibufferp` compatibility slice:
  - aligned arity to GNU behavior (accepts 0..=2 args; >2 is `wrong-number-of-arguments`)
  - added buffer-like validation for the first arg (`nil` / string / buffer accepted; otherwise `wrong-type-argument bufferp ...`)
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/minibufferp-semantics.forms`
    - `test/neovm/vm-compat/cases/minibufferp-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test builtin_minibufferp -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/minibufferp-semantics.forms EXPECTED=cases/minibufferp-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Reduced dead search shim surface after evaluator routing:
  - removed unused `search.rs` eval-stub wrappers (`posix-search-*`, `word-search-*`, `search-forward/backward`, `re-search-forward/backward`, `replace-match`) now superseded by `builtins.rs` evaluator implementations
  - re-verified search slices after cleanup:
    - `cargo test search::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/search-buffer.forms EXPECTED=cases/search-buffer.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/search-posix-word-semantics.forms EXPECTED=cases/search-posix-word-semantics.expected.tsv` (pass)
- Implemented `exit-recursive-edit` compatibility slice:
  - replaced nil stub behavior with GNU-compatible `user-error` in batch when no recursive edit is active
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/exit-recursive-edit-semantics.forms`
    - `test/neovm/vm-compat/cases/exit-recursive-edit-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test builtin_exit_recursive_edit -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/exit-recursive-edit-semantics.forms EXPECTED=cases/exit-recursive-edit-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented `posix-search-*` / `word-search-*` evaluator fallback slice:
  - replaced nil-stub dispatch paths by routing:
    - `posix-search-forward` / `posix-search-backward` -> evaluator regex search paths
    - `word-search-forward` / `word-search-backward` -> evaluator literal search paths
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/search-posix-word-semantics.forms`
    - `test/neovm/vm-compat/cases/search-posix-word-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/search-posix-word-semantics.forms EXPECTED=cases/search-posix-word-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Re-ran full vm-compat verification and fixed a real regression:
  - `make -C test/neovm/vm-compat check-all-neovm` initially exposed a mismatch in `cases/internal-lisp-face-comparators` for string face designators (`"default"`)
  - patched `internal-lisp-face-empty-p` / `internal-lisp-face-equal-p` face resolution to accept valid string face names with GNU-compatible invalid-face payloads
  - added targeted Rust unit coverage for string-face comparator paths
  - re-verified:
    - `cargo test internal_lisp_face_ -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-lisp-face-comparators.forms EXPECTED=cases/internal-lisp-face-comparators.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Implemented `internal-set-alternative-font-family-alist` / `internal-set-alternative-font-registry-alist` compatibility slice:
  - replaced nil stubs with proper-list validation and oracle-compatible payloads (`wrong-type-argument listp ...` on dotted/non-list entries)
  - `internal-set-alternative-font-family-alist` now converts validated string members to symbols and returns normalized alist shape
  - `internal-set-alternative-font-registry-alist` now validates list shape and returns the original alist payload
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/alternative-font-alists-semantics.forms`
    - `test/neovm/vm-compat/cases/alternative-font-alists-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make -C test/neovm/vm-compat check FORMS=cases/alternative-font-alists-semantics.forms EXPECTED=cases/alternative-font-alists-semantics.expected.tsv` (pass)
    - `NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make -C test/neovm/vm-compat check-neovm FORMS=cases/alternative-font-alists-semantics.forms EXPECTED=cases/alternative-font-alists-semantics.expected.tsv` (pass)
- Implemented `internal-set-font-selection-order` compatibility slice:
  - replaced nil stub with oracle-compatible validation: accepts only permutations of `(:width :height :weight :slant)` and reports GNU-style list/type/error payloads for invalid orders
  - preserved batch behavior where valid orders return `nil` without mutating the exposed compatibility surface
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/internal-set-font-selection-order-semantics.forms`
    - `test/neovm/vm-compat/cases/internal-set-font-selection-order-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-set-font-selection-order-semantics.forms EXPECTED=cases/internal-set-font-selection-order-semantics.expected.tsv` (pass)
- Implemented `face-font` compatibility slice:
  - aligned face argument semantics with oracle behavior (known symbol/string faces return `nil`, invalid faces keep oracle-compatible `Invalid face` payloads)
  - preserved optional-argument behavior (`FRAME`/`CHARACTER` accepted and ignored for valid faces in batch compatibility path)
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/face-font-semantics.forms`
    - `test/neovm/vm-compat/cases/face-font-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/face-font-semantics.forms EXPECTED=cases/face-font-semantics.expected.tsv` (pass)
- Implemented `face-id` compatibility slice:
  - replaced fixed-id stub with oracle-compatible ids for core faces and dynamic-id allocation for faces created via `internal-make-lisp-face`
  - aligned argument semantics: accepts optional second argument (ignored), keeps string first-arg `symbolp` type checks, and preserves oracle-style `Not a face: ...` error payloads
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/face-id-semantics.forms`
    - `test/neovm/vm-compat/cases/face-id-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/face-id-semantics.forms EXPECTED=cases/face-id-semantics.expected.tsv` (pass)
- Implemented `internal-merge-in-global-face` compatibility slice:
  - replaced stub behavior with frame/face validation and merge semantics that copy concrete defaults-face overrides into selected-frame face state
  - merged values now align with oracle behavior for defaults-to-selected propagation and ignore relative defaults (for example `unspecified`)
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/internal-merge-in-global-face-semantics.forms`
    - `test/neovm/vm-compat/cases/internal-merge-in-global-face-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-merge-in-global-face-semantics.forms EXPECTED=cases/internal-merge-in-global-face-semantics.expected.tsv` (pass)
- Implemented `internal-set-lisp-face-attribute` compatibility slice:
  - replaced stub behavior with oracle-compatible argument checking, frame domain routing (`nil`/`t`/`0`), and return value (`FACE`)
  - added selected/default face override state and connected it to `internal-get-lisp-face-attribute`, `internal-lisp-face-equal-p`, `internal-lisp-face-empty-p`, `internal-make-lisp-face`, and `internal-copy-lisp-face`
  - added set-path validation and normalization for high-impact attributes (`:foreground`, `:background`, `:height`, `:weight`, `:slant`, `:width`, `:inherit`, `:bold`, `:italic`, `:inverse-video`, `:extend`)
  - added and enabled oracle corpus:
    - `test/neovm/vm-compat/cases/internal-set-lisp-face-attribute-semantics.forms`
    - `test/neovm/vm-compat/cases/internal-set-lisp-face-attribute-semantics.expected.tsv`
    - wired into `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-set-lisp-face-attribute-semantics.forms EXPECTED=cases/internal-set-lisp-face-attribute-semantics.expected.tsv` (pass)
- Added display/terminal stub compatibility slice:
  - exposed and wired display-side builtins: `redraw-frame`, `redraw-display`, `open-termscript`, `ding`, `send-string-to-terminal`, `internal-show-cursor`, `internal-show-cursor-p`
  - exposed `last-nonminibuffer-frame` and locked current batch behavior to oracle
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/display-stub-semantics.forms`
    - `test/neovm/vm-compat/cases/display-stub-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `make -C test/neovm/vm-compat record FORMS=cases/display-stub-semantics.forms EXPECTED=cases/display-stub-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-stub-semantics.forms EXPECTED=cases/display-stub-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Expanded display/terminal stub semantics to match more oracle behavior:
  - `redraw-frame` now enforces frame designator type checks (`frame-live-p` predicate payload)
  - `open-termscript` now signals the batch tty error payload used by GNU Emacs
  - `send-string-to-terminal` now validates optional terminal designators (`terminal-live-p` predicate payload)
  - `internal-show-cursor` / `internal-show-cursor-p` now enforce window designator shape and maintain shared visibility state
  - expanded oracle corpus (`cases/display-stub-semantics`) with error payload and designator checks
  - verified:
    - `cargo test display::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/display-stub-semantics.forms EXPECTED=cases/display-stub-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Added TTY batch semantics compatibility slice:
  - `tty-type`, `tty-top-frame`, `controlling-tty-p` now reject invalid terminal designators with `wrong-type-argument` (`terminal-live-p` payload)
  - `suspend-tty` and `resume-tty` now signal GNU-compatible non-text terminal `error` payloads in batch mode while preserving type checks on invalid designators
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/tty-batch-semantics.forms`
    - `test/neovm/vm-compat/cases/tty-batch-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test display::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/tty-batch-semantics.forms EXPECTED=cases/tty-batch-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Added X display batch semantics compatibility slice:
  - `x-open-connection` now enforces string display argument typing and returns display-open errors in batch context
  - `x-close-connection` now dispatches batch-compatible error classes for nil/string/non-frame designators
  - `x-display-pixel-width` / `x-display-pixel-height` now signal batch/X-not-available errors and frame-designator type errors
  - `x-display-color-p` now returns `nil` for batch current display and reports argument-shape errors for invalid designators
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/x-display-batch-semantics.forms`
    - `test/neovm/vm-compat/cases/x-display-batch-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test display::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/x-display-batch-semantics.forms EXPECTED=cases/x-display-batch-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Added font batch semantics compatibility slice:
  - `list-fonts` and `find-font` now enforce `font-spec` argument typing and preserve batch-mode nil results for valid specs
  - `font-family-list` now matches batch defaults (`nil`) and rejects non-nil frame designators with `frame-live-p` type predicate payload
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/font-batch-semantics.forms`
    - `test/neovm/vm-compat/cases/font-batch-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/font-batch-semantics.forms EXPECTED=cases/font-batch-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Added face batch semantics compatibility slice:
  - `face-id` now signals GNU-compatible invalid-face errors for non-face designators while preserving `default` face baseline id behavior
  - `face-font` now signals GNU-compatible invalid-face errors for non-face designators and keeps batch `nil` default-face behavior
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/face-batch-semantics.forms`
    - `test/neovm/vm-compat/cases/face-batch-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/face-batch-semantics.forms EXPECTED=cases/face-batch-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Added timer compatibility slice (`run-at-time` / `run-with-idle-timer` / `timer-activate`):
  - `run-at-time` now accepts GNU-compatible immediate specs for `nil` and numeric-prefixed strings like `"0 sec"` (while invalid specs signal `error`)
  - `run-with-timer` compatibility is now lock-in covered for numeric, `nil`, and `"0 sec"` immediate forms
  - `run-with-idle-timer` now accepts `nil` delay and keeps non-numeric delay specs as `error`
  - `timer-activate` now matches error-class behavior on invalid/active timer activation paths
  - `sleep-for` is now exposed in builtin registry/dispatch and matches core GNU argument/error semantics in batch mode
  - `sit-for` now enforces GNU-compatible arity bounds (1..=2 args; extra args signal `wrong-number-of-arguments`)
  - timer corpus now locks additional timer arity/error paths (`timerp`, `cancel-timer`, `timer-activate`) under `condition-case`
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/timer-semantics.forms`
    - `test/neovm/vm-compat/cases/timer-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test test_eval_run_at_time -- --nocapture` (pass)
    - `cargo test test_eval_run_with_idle_timer_nil_ok_string_error -- --nocapture` (pass)
    - `cargo test test_eval_timer_activate -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/timer-semantics.forms EXPECTED=cases/timer-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Added `minibuffer-contents-no-properties` builtin compatibility slice:
  - implemented evaluator-aware builtin in `neovm-core` with batch behavior matching `minibuffer-contents`
  - wired builtin dispatch and registry exposure (`fboundp`/dispatch parity)
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/minibuffer-contents-no-properties-semantics.forms`
    - `test/neovm/vm-compat/cases/minibuffer-contents-no-properties-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test minibuffer_contents_no_properties -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/minibuffer-contents-no-properties-semantics.forms EXPECTED=cases/minibuffer-contents-no-properties-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Fixed vm-compat raw-byte string rendering in worker execution path:
  - added byte-preserving evaluator-aware helpers in `neovm-core` (`print_value_bytes_with_eval`, `format_eval_result_bytes_with_eval`)
  - switched `neovm-core` compat runner output to buffered byte writes
  - switched `neovm-worker` elisp executor result rendering to `print_value_bytes_with_eval`
- Re-verified non-Unicode oracle slices and full suite:
  - `make -C test/neovm/vm-compat check-neovm FORMS=cases/make-string-raw-byte-semantics.forms EXPECTED=cases/make-string-raw-byte-semantics.expected.tsv` (pass)
  - `make -C test/neovm/vm-compat check-neovm FORMS=cases/make-string-nonunicode-semantics.forms EXPECTED=cases/make-string-nonunicode-semantics.expected.tsv` (pass)
  - `make -C test/neovm/vm-compat check-neovm FORMS=cases/string-nonunicode-char-semantics.forms EXPECTED=cases/string-nonunicode-char-semantics.expected.tsv` (pass)
  - `make -C test/neovm/vm-compat check-neovm FORMS=cases/string-nonunicode-indexing-semantics.forms EXPECTED=cases/string-nonunicode-indexing-semantics.expected.tsv` (pass)
  - `make -C test/neovm/vm-compat check-neovm FORMS=cases/string-nonunicode-concat-semantics.forms EXPECTED=cases/string-nonunicode-concat-semantics.expected.tsv` (pass)
  - `make -C test/neovm/vm-compat check-neovm FORMS=cases/string-nonunicode-sequence-semantics.forms EXPECTED=cases/string-nonunicode-sequence-semantics.expected.tsv` (pass)
  - `make -C test/neovm/vm-compat check-all-neovm` (pass)
- Aligned `documentation` builtin semantics with oracle behavior:
  - `function-documentation` property now takes precedence for symbol arguments
  - symbol lookup now distinguishes `void-function` and `invalid-function` paths
  - non-callable non-symbol function arguments now signal `invalid-function`
  - lambda/defmacro evaluation now captures docstring metadata in `LambdaData`
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/documentation-semantics.forms`
  - `test/neovm/vm-compat/cases/documentation-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list` and `test/neovm/vm-compat/cases/introspection.list`
- Verified the documentation slice end-to-end:
  - `cargo test documentation_ -- --nocapture` (pass)
  - `cargo test captures_docstring_metadata -- --nocapture` (pass)
  - `cd test/neovm/vm-compat && make check-neovm FORMS=cases/documentation-semantics.forms EXPECTED=cases/documentation-semantics.expected.tsv` (pass)
  - `cd test/neovm/vm-compat && make check-neovm FORMS=cases/documentation-property-semantics.forms EXPECTED=cases/documentation-property-semantics.expected.tsv` (pass)
  - `cd test/neovm/vm-compat && make validate-case-lists` (pass)
- Implemented evaluator-aware `documentation-property` semantics:
  - reads symbol plist entries through evaluator obarray state
  - returns string-valued properties, maps non-string property values to `nil`
  - preserves `wrong-type-argument` on non-symbol first arg and `nil` on non-symbol property key
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/documentation-property-semantics.forms`
  - `test/neovm/vm-compat/cases/documentation-property-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list` and `test/neovm/vm-compat/cases/introspection.list`
- Verified compatibility and list integrity for the slice:
  - `cd test/neovm/vm-compat && make check-neovm FORMS=cases/documentation-property-semantics.forms EXPECTED=cases/documentation-property-semantics.expected.tsv` (pass)
  - `cd test/neovm/vm-compat && make validate-case-lists` (pass)
- Aligned compat/worker result rendering with evaluator-aware opaque handle formatting:
  - added `format_eval_result_with_eval` and `print_value_with_eval` in `neovm-core`
  - switched vm-compat runner output to evaluator-aware formatting path
  - switched worker task result byte rendering to evaluator-aware handle printing
- Re-verified thread compatibility corpus after rendering path update:
  - `cd test/neovm/vm-compat && make check-thread-neovm` (pass)
- Full suite re-verified after JSON keyword-error and display batch-semantics slices:
  - `cd test/neovm/vm-compat && make check-all-neovm` (pass)
- Full suite re-verified after JSON buffer builtin routing + cl_lib JSON cleanup:
  - `cd test/neovm/vm-compat && make check-all-neovm` (pass)
- Full suite baseline verified after JSON compatibility slice:
  - `cd test/neovm/vm-compat && NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make check-all-neovm` (pass)
- Full suite baseline verified after `set-time-zone-rule` / `current-time-zone` slice:
  - `cd test/neovm/vm-compat && NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make check-all-neovm` (pass)
- Full suite baseline verified after `safe-date-to-time` slice:
  - `cd test/neovm/vm-compat && NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make check-all-neovm` (pass)
- Full suite baseline verified after latest cleanup:
  - `cd test/neovm/vm-compat && make check-all-neovm` (pass)
- Full suite re-verified after terminal parameter semantics slice:
  - `cd test/neovm/vm-compat && NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make check-all-neovm` (pass)
- Added a builtin-registry-wide `fboundp` parity checker against GNU Emacs `-Q`:
  - `test/neovm/vm-compat/check-builtin-registry-fboundp.sh`
  - allowlist: `test/neovm/vm-compat/cases/builtin-registry-fboundp-allowlist.txt`
- Added `make` target:
  - `make -C test/neovm/vm-compat check-builtin-registry-fboundp`
- Wired the parity gate into CI:
  - `.github/workflows/vm-compat.yml`
- Documented the gate in:
  - `test/neovm/vm-compat/README.md`
  - `docs/elisp-vm-design.md`
- Removed multiple unexposed/stale builtin implementations to keep dispatch surface aligned with the registry and oracle policy:
  - `custom-group-p` implementation cleanup
  - `selected-terminal` implementation cleanup
  - `display-line-numbers-update-width` implementation cleanup
  - `register-to-string` implementation cleanup
  - `extract-rectangle-line` implementation cleanup
  - removed stale misc stubs superseded by evaluator paths
  - removed unexposed bookmark helper builtin implementations
  - removed unexposed `string-repeat` helper implementation
  - removed unexposed `bool-vector-complement` implementation
  - removed unexposed `base64url-decode-string` helper
  - removed unexposed `hash-table-keys` / `hash-table-values` helpers
  - removed unexposed `downcase-char` helper
  - removed unexposed `find-coding-system` helper
  - removed unexposed `word-at-point` helper
  - removed stale, unreferenced `elisp/terminal` shim module files
  - removed stale, unreferenced pure-JSON buffer stub helpers from `elisp/json.rs` (`json-insert`/`json-parse-buffer`; replaced by active evaluator-backed implementations in the JSON module)
  - removed duplicate legacy JSON parser/serializer + tests from `elisp/cl_lib.rs` so `elisp/json.rs` is the single JSON implementation path
- Implemented `terminal-parameter` / `set-terminal-parameter` compatibility semantics:
  - persisted terminal parameter values for symbol keys
  - `terminal-parameter` enforces `symbolp` for PARAMETER
  - `set-terminal-parameter` returns `nil` (and ignores non-symbol keys)
  - invalid terminal designators now signal `wrong-type-argument` with `terminal-live-p`
  - `terminal-live-p` now returns `nil` for invalid designator shapes
  - `terminal-name` now rejects invalid terminal designators
  - switched terminal designators to an opaque internal terminal handle
  - `frame-terminal` now rejects invalid frame designators (`wrong-type-argument` on non-nil non-frame)
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/terminal-parameter-semantics.forms`
  - `test/neovm/vm-compat/cases/terminal-parameter-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Implemented `safe-date-to-time` compatibility subset:
  - parse and convert explicit-offset date formats (ISO/slash and RFC-style)
  - return `(HIGH LOW)` for valid dates, integer `0` for non-parseable/non-string inputs
  - preserve wrong-arity signaling
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/safe-date-to-time-semantics.forms`
  - `test/neovm/vm-compat/cases/safe-date-to-time-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Implemented `set-time-zone-rule` / `current-time-zone` compatibility subset:
  - process-level time zone rule state (`nil`/`wall`, `t`, integer offsets, TZ strings)
  - deterministic offset-name rendering for fixed offset rules
  - invalid specification signaling (`error "Invalid time zone specification"`)
  - `current-time-zone` now honors explicit `ZONE` argument overrides
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/time-zone-rule-semantics.forms`
  - `test/neovm/vm-compat/cases/time-zone-rule-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Implemented JSON compatibility adjustments:
  - `json-serialize` alist key typing now follows Emacs `symbolp` expectations
  - `json-parse-string` `:object-type 'alist` now emits symbol keys
  - parser now signals `json-end-of-file` for empty/whitespace-only input
  - trailing-content signal now uses `json-trailing-content`
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/json-semantics.forms`
  - `test/neovm/vm-compat/cases/json-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Aligned evaluator-backed buffer JSON builtins with Emacs behavior:
  - `json-parse-buffer` now parses from current point, allows trailing content, and advances point to the end of parsed value
  - `json-insert` now uses `json-serialize` keyword semantics (`:null-object`, `:false-object`)
  - dispatch for `json-parse-buffer` / `json-insert` now routes to `elisp/json.rs` implementations
- Aligned JSON keyword-argument error semantics with Emacs:
  - odd JSON plist tails now signal `(wrong-type-argument plistp ...)`
  - unknown JSON keyword args now signal `error` with Emacs-compatible message + offending value payload
  - invalid `:array-type` / `:object-type` values now signal Emacs-compatible `error` payloads
- Aligned display query builtins with Emacs batch-context defaults:
  - display queries now report terminal-style values in vm-compat context (`display-graphic-p`, `display-color-p`, pixel/mm size, color cells/planes/class/backing store, `x-display-list`)
  - preserved terminal-handle parameter semantics separately (`terminal-parameter` corpus remains green)
- Aligned terminal handle and terminal-name presentation semantics:
  - `terminal-name` now returns `\"initial_terminal\"` for the current terminal
  - `prin1-to-string` / `format` / error-message rendering now print terminal handles as `#<terminal ...>` (parity with GNU Emacs handle style)
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/json-buffer-semantics.forms`
  - `test/neovm/vm-compat/cases/json-buffer-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/json-keyword-errors.forms`
  - `test/neovm/vm-compat/cases/json-keyword-errors.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/display-batch-semantics.forms`
  - `test/neovm/vm-compat/cases/display-batch-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/terminal-handle-printing.forms`
  - `test/neovm/vm-compat/cases/terminal-handle-printing.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Aligned monitor attribute builtins with batch-style oracle semantics:
  - `display-monitor-attributes-list` / `frame-monitor-attributes` now return batch-size geometry/workarea `(0 0 80 25)`, `mm-size` as `(nil nil)`, and stable key shape (`geometry`, `workarea`, `mm-size`, `frames`)
  - invalid non-`nil` monitor designators now signal `error` (oracle-aligned class for `get-device-terminal` argument failures)
  - `frame-monitor-attributes` accepts terminal handles for terminal-associated monitor lookup semantics
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/display-monitor-semantics.forms`
  - `test/neovm/vm-compat/cases/display-monitor-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Aligned generic value printer with terminal-handle rendering:
  - top-level/result printing now renders terminal handles as `#<terminal ...>` instead of raw vector internals
  - byte-printing path (`print_value_bytes`) now mirrors the same terminal-handle representation
- Expanded oracle corpus for terminal-handle top-level rendering:
  - `test/neovm/vm-compat/cases/terminal-handle-printing.forms` now includes raw `(frame-terminal)` / `(car (terminal-list))` output checks
  - refreshed `test/neovm/vm-compat/cases/terminal-handle-printing.expected.tsv`
- Aligned batch frame introspection bootstrap semantics:
  - `selected-frame` / `frame-list` now synthesize the initial `F1` frame lazily when no frame exists yet in evaluator state
  - keeps batch introspection paths (`framep`, `frame-live-p`, `frame-list` membership) oracle-aligned without requiring editor-side frame bootstrap
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/frame-batch-semantics.forms`
  - `test/neovm/vm-compat/cases/frame-batch-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Aligned monitor `frames` slot with live evaluator frame set:
  - added evaluator-aware monitor dispatch so `display-monitor-attributes-list` / `frame-monitor-attributes` populate `frames` from `frame-list`
  - monitor queries now bootstrap and expose one live frame in batch mode (matching oracle shape expectations)
- Added and enabled new oracle corpus:
  - `test/neovm/vm-compat/cases/display-monitor-frames-semantics.forms`
  - `test/neovm/vm-compat/cases/display-monitor-frames-semantics.expected.tsv`
  - wired into `test/neovm/vm-compat/cases/default.list`
- Aligned internal face introspection builtins with oracle semantics:
  - `internal-lisp-face-p` now returns face vectors for known faces, `nil` for unknown/non-face inputs, and validates optional frame designators (`frame-live-p` payload)
  - `internal-get-lisp-face-attribute` now validates optional frame argument (`nil`/`t` or live-frame type check), validates face/attribute error payloads, and returns oracle-compatible values for core faces in batch mode
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/internal-lisp-face-semantics.forms`
    - `test/neovm/vm-compat/cases/internal-lisp-face-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-lisp-face-semantics.forms EXPECTED=cases/internal-lisp-face-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Aligned additional internal face builtins with oracle semantics:
  - implemented and registered `internal-lisp-face-attribute-values`, `internal-lisp-face-empty-p`, and `internal-lisp-face-equal-p`
  - `internal-lisp-face-attribute-values` now returns `(t nil)` for discrete boolean face attributes and preserves symbol/type/arity error semantics
  - `internal-lisp-face-empty-p` / `internal-lisp-face-equal-p` now validate frame argument shape first, resolve face designators (symbol/string) with oracle-compatible invalid-face payloads, and honor `FRAME=t` default-face behavior
  - expanded core built-in face attribute map used by comparisons (`highlight`/`region`/`mode-line` inverse-video, `mode-line-inactive` inherit, `fringe` background, `cursor` background)
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/internal-lisp-face-comparators.forms`
    - `test/neovm/vm-compat/cases/internal-lisp-face-comparators.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-lisp-face-comparators.forms EXPECTED=cases/internal-lisp-face-comparators.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make -C test/neovm/vm-compat check-builtin-registry-fboundp` (pass; expected allowlisted drift only)
- Added deep matrix oracle lock-in for `internal-get-lisp-face-attribute`:
  - new corpus covers full core-face x attribute matrix in selected-frame mode plus defaults-frame (`FRAME=t`) sampling and error/arity payloads
  - added:
    - `test/neovm/vm-compat/cases/internal-get-lisp-face-attribute-matrix.forms`
    - `test/neovm/vm-compat/cases/internal-get-lisp-face-attribute-matrix.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-get-lisp-face-attribute-matrix.forms EXPECTED=cases/internal-get-lisp-face-attribute-matrix.expected.tsv` (pass, 271/271)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Aligned and locked-in make/copy Lisp face helper semantics:
  - registered `internal-make-lisp-face` in NeoVM builtin dispatch/registry and implemented Oracle-compatible argument checks and frame error payloads
  - updated `internal-copy-lisp-face` to match Oracle ordering and behavior: symbol checks first, `FRAME=t` fast-path, non-`t` frame `wrong-type-argument` payloads, source-face validity checks, and destination face visibility via `internal-lisp-face-p`
  - wired created-face visibility state so faces created via `internal-make-lisp-face` / `internal-copy-lisp-face` are discoverable by `internal-lisp-face-p` (without broadening `internal-get-lisp-face-attribute` validity surface)
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/internal-make-copy-lisp-face-semantics.forms`
    - `test/neovm/vm-compat/cases/internal-make-copy-lisp-face-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test font::tests -- --nocapture` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-lisp-face-semantics.forms EXPECTED=cases/internal-lisp-face-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-lisp-face-comparators.forms EXPECTED=cases/internal-lisp-face-comparators.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/internal-make-copy-lisp-face-semantics.forms EXPECTED=cases/internal-make-copy-lisp-face-semantics.expected.tsv` (pass, 42/42)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
    - `NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make -C test/neovm/vm-compat check-builtin-registry-fboundp` (pass; expected allowlisted drift only)
- Implemented and locked-in `get-byte` semantics (string + buffer paths):
  - moved `get-byte` dispatch to evaluator-dependent path so buffer/point semantics are available
  - aligned string behavior:
    - zero-based character indexing
    - `nil` position default
    - `args-out-of-range` payloads
    - `wholenump` validation for string indices
    - non-ASCII/non-byte8 error message payloads
  - aligned buffer behavior:
    - 1-based character positions against accessible range
    - `(get-byte nil)` at point and end-of-buffer `0` behavior
    - `args-out-of-range` payload shape `(pos point-min point-max)`
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/get-byte-semantics.forms`
    - `test/neovm/vm-compat/cases/get-byte-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml get_byte -- --nocapture` (pass)
    - `NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make -C test/neovm/vm-compat record FORMS=cases/get-byte-semantics.forms EXPECTED=cases/get-byte-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/get-byte-semantics.forms EXPECTED=cases/get-byte-semantics.expected.tsv` (pass, 21/21)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Implemented and locked-in `char-resolve-modifiers` semantics:
  - replaced passthrough behavior with modifier resolution that matches oracle for shift/control/meta interactions
  - aligned wrong-type payload to `(wrong-type-argument fixnump <value>)`
  - fixed `S-A` normalization to clear the shift bit (oracle parity)
  - added oracle corpus:
    - `test/neovm/vm-compat/cases/char-resolve-modifiers-semantics.forms`
    - `test/neovm/vm-compat/cases/char-resolve-modifiers-semantics.expected.tsv`
    - enabled in `test/neovm/vm-compat/cases/default.list`
  - verified:
    - `cargo test --manifest-path rust/neovm-core/Cargo.toml char_resolve_modifiers -- --nocapture` (pass)
    - `NEOVM_ORACLE_EMACS=/nix/store/hql3zwz5b4ywd2qwx8jssp4dyb7nx4cb-emacs-30.2/bin/emacs make -C test/neovm/vm-compat record FORMS=cases/char-resolve-modifiers-semantics.forms EXPECTED=cases/char-resolve-modifiers-semantics.expected.tsv` (pass)
    - `make -C test/neovm/vm-compat check-neovm FORMS=cases/char-resolve-modifiers-semantics.forms EXPECTED=cases/char-resolve-modifiers-semantics.expected.tsv` (pass, 14/14)
    - `make -C test/neovm/vm-compat validate-case-lists` (pass)
- Kept branch green with targeted Rust tests and vm-compat checks after each slice.

## Doing

- Continue compatibility-first maintenance with small commit slices:
  - keep builtin surface and registry in lock-step
  - run oracle/parity checks after each behavior-affecting change
  - remove dead helper code that is not part of exposed compatibility surface
- Identify the next high-impact builtin still stubbed in NeoVM core and land it as a small implementation + oracle-corpus lock-in slice.
- Reduce vm-compat operator friction for large case sets (small Makefile UX improvements).
  - added list-driven targets: `record-list`, `check-list`, `check-neovm-list` with `LIST=cases/<name>.list`

## Next

1. Keep `check-all-neovm` as a recurring post-slice gate (detect regressions before they batch up).
2. Expand focused oracle corpora for remaining high-risk areas still carrying stubs (search/input/minibuffer/display edges).
3. Prioritize one high-impact stub-to-real implementation slice with oracle lock-in, then repeat.
4. Keep Rust backend behind compile-time switch and preserve Emacs C core as default backend.
