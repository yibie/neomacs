; locate-file and locate-file-internal compatibility behavior.
(progn
  (setq vm-locate-dir (expand-file-name "locate-file-fixtures" (file-name-directory (getenv "NEOVM_FORMS_FILE"))))
  'ok)

(file-name-nondirectory (locate-file "vm-locate-probe" (list vm-locate-dir) '(".el" ".xelc")))
(file-name-nondirectory (locate-file "vm-locate-probe" (list vm-locate-dir) '(".xelc")))
(locate-file "vm-locate-missing" (list vm-locate-dir) '(".el" ".xelc"))

(file-name-nondirectory (locate-file-internal "vm-locate-probe" (list vm-locate-dir) '(".xelc")))
(locate-file-internal "vm-locate-missing" (list vm-locate-dir) '(".el"))

(file-name-nondirectory (locate-file "vm-locate-probe" (list vm-locate-dir) '(".el") 'file-regular-p))
(locate-file "vm-locate-probe" (list vm-locate-dir) '(".el") 'file-directory-p)
(condition-case err
    (locate-file "vm-locate-probe" (list vm-locate-dir) '(".el") 'definitely-not-a-real-predicate)
  (error (car err)))
(condition-case err
    (locate-file "vm-locate-probe" (list vm-locate-dir) '(".el") nil nil)
  (error (car err)))
(condition-case err
    (locate-file-internal "vm-locate-probe" (list vm-locate-dir) '(".el") nil nil)
  (error (car err)))
