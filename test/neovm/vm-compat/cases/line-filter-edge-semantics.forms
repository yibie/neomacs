(with-temp-buffer
  (insert (concat "a" (string 10) "bb" (string 10) "c" (string 10)))
  (goto-char (point-max))
  (keep-lines "b" 9 1)
  (list (point) (split-string (buffer-string) (string 10) t)))

(with-temp-buffer
  (insert (concat "aa" (string 10) "bb" (string 10) "cc" (string 10) "dd" (string 10)))
  (goto-char (point-max))
  (keep-lines "b" 4 10)
  (list (point) (split-string (buffer-string) (string 10) t)))

(with-temp-buffer
  (insert (concat "a" (string 10) "bb" (string 10) "c" (string 10)))
  (goto-char (point-max))
  (flush-lines "b" 9 1)
  (list (point) (split-string (buffer-string) (string 10) t)))

(with-temp-buffer
  (insert (concat "aa" (string 10) "bb" (string 10) "cc" (string 10) "dd" (string 10)))
  (goto-char (point-max))
  (flush-lines "b" 4 10)
  (list (point) (split-string (buffer-string) (string 10) t)))

(with-temp-buffer
  (insert (concat "a" (string 10) "bb" (string 10) "c" (string 10)))
  (flush-lines "b"))

(with-temp-buffer
  (insert (concat "a" (string 10) "bb" (string 10) "c" (string 10)))
  (flush-lines "z"))

(with-temp-buffer
  (insert (concat "a" (string 10) "bb" (string 10) "c" (string 10)))
  (setq buffer-read-only t)
  (flush-lines "b"))
