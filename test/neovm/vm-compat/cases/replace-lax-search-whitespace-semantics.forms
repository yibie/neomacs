(with-temp-buffer
  (insert (concat "a" (char-to-string 10) "b"))
  (goto-char (point-min))
  (let ((replace-lax-whitespace t)
        (search-whitespace-regexp (concat (char-to-string 9) "+")))
    (replace-string "a b" "X"))
  (equal (buffer-string) "X"))

(with-temp-buffer
  (insert (concat "a" (char-to-string 9) "b"))
  (goto-char (point-min))
  (let ((replace-lax-whitespace t)
        (search-whitespace-regexp (concat (char-to-string 9) "+")))
    (replace-string "a b" "X"))
  (equal (buffer-string) "X"))

(with-temp-buffer
  (insert (concat "a" (char-to-string 10) "b"))
  (goto-char (point-min))
  (let ((replace-lax-whitespace t)
        (search-whitespace-regexp (concat (char-to-string 9) "+"))
        (unread-command-events (list ?!)))
    (query-replace "a b" "X"))
  (equal (buffer-string) "X"))

(with-temp-buffer
  (insert (concat "a" (char-to-string 9) "b"))
  (goto-char (point-min))
  (let ((replace-lax-whitespace t)
        (search-whitespace-regexp 1)
        (unread-command-events (list ?!)))
    (query-replace "a b" "X"))
  (equal (buffer-string) "X"))
