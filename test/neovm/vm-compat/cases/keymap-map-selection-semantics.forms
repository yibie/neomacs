(fboundp 'current-global-map)
(fboundp 'current-local-map)
(fboundp 'use-global-map)
(fboundp 'use-local-map)

(condition-case err (keymapp (current-global-map)) (error err))
(condition-case err (current-local-map) (error err))
(condition-case err (let ((m (make-sparse-keymap))) (use-local-map m) (equal (current-local-map) m)) (error err))
(condition-case err (progn (use-local-map nil) (current-local-map)) (error err))
(condition-case err (let ((m (make-sparse-keymap))) (use-global-map m) (equal (current-global-map) m)) (error err))

(condition-case err (current-global-map nil) (error (car err)))
(condition-case err (current-local-map nil) (error (car err)))
(condition-case err (use-global-map) (error (car err)))
(condition-case err (use-local-map) (error (car err)))
