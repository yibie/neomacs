; buffer-local-variables explicit-local semantics subset.

(listp (buffer-local-variables))

(let ((v (make-local-variable 'neovm-blv-probe)))
  (set v 42)
  (cdr (assq 'neovm-blv-probe (buffer-local-variables))))

(with-temp-buffer
  (let ((v (make-local-variable 'neovm-blv-probe2)))
    (set v 99)
    (let ((b (current-buffer)))
      (cdr (assq 'neovm-blv-probe2 (buffer-local-variables b))))))

(condition-case err
    (let ((b (get-buffer-create "neovm-blv-buffer")))
      (unwind-protect
          (buffer-local-variables "neovm-blv-buffer")
        (kill-buffer b)))
  (error err))

(condition-case err
    (buffer-local-variables 1)
  (error err))

(condition-case err
    (buffer-local-variables nil nil)
  (error err))

(with-temp-buffer
  (assq 'neovm-blv-missing (buffer-local-variables)))
