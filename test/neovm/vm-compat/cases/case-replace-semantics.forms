(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t))
    (replace-string "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace nil))
    (replace-string "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search nil)
        (case-replace t))
    (replace-string "Foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "FOO")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t))
    (replace-string "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t))
    (replace-string "foo" "bAr"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t))
    (replace-regexp "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace nil))
    (replace-regexp "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t)
        (unread-command-events (list ?!)))
    (query-replace "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace nil)
        (unread-command-events (list ?!)))
    (query-replace "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t)
        (unread-command-events (list ?!)))
    (query-replace-regexp "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace nil)
        (unread-command-events (list ?!)))
    (query-replace-regexp "foo" "bar"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t))
    (replace-regexp "foo" "bAr"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t)
        (unread-command-events (list ?!)))
    (query-replace "foo" "bAr"))
  (buffer-string))

(with-temp-buffer
  (insert "Foo")
  (goto-char (point-min))
  (let ((case-fold-search t)
        (case-replace t)
        (unread-command-events (list ?!)))
    (query-replace-regexp "foo" "bAr"))
  (buffer-string))
