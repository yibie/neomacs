; `load` path semantics: `load-path` nil entry uses `default-directory`
(progn
  (setq vm-rel-root (expand-file-name "load-relative-fixtures" (file-name-directory (getenv "NEOVM_FORMS_FILE"))))
  (setq vm-rel-cwd (expand-file-name "cwd" vm-rel-root))
  (setq vm-rel-loadpath (expand-file-name "loadpath" vm-rel-root))
  (setq default-directory vm-rel-cwd)
  (setq load-path (cons vm-rel-loadpath '(nil)))
  'ok)

(setq vm-rel-choice nil)
(load "./vm-rel-choice" nil nil nil nil)
vm-rel-choice

(setq vm-rel-choice nil)
(load "./vm-rel-only-loadpath" nil nil nil nil)
vm-rel-choice

(setq vm-rel-choice nil)
(load "vm-rel-only-cwd" nil nil nil nil)
vm-rel-choice
