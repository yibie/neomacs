; NeoVM policy behavior: source-only load path, explicit `.elc` rejection, safe `.neoc` fallback.
(progn
  (setq vm-policy-dir (expand-file-name "load-policy-fixtures" (file-name-directory (getenv "NEOVM_FORMS_FILE"))))
  (setq load-path (cons vm-policy-dir load-path))
  'ok)

(get-load-suffixes)
(member ".elc" (get-load-suffixes))
(member ".elc.gz" (get-load-suffixes))

(setq vm-policy-cache-probe nil)
(load "vm-policy-cache-probe" nil nil nil nil)
vm-policy-cache-probe

(condition-case err (load "vm-policy-only-elc.elc" nil nil nil nil) (error (car err)))
(condition-case err (load "vm-policy-only-elc" nil nil nil nil) (error (car err)))

(setq vm-policy-sibling nil)
(condition-case err (load "vm-policy-sibling.elc" nil nil nil nil) (error (car err)))
vm-policy-sibling
