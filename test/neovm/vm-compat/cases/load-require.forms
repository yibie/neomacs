; load/require behavior with deterministic fixture files
(progn
  (setq vm-load-dir (expand-file-name "load-require-fixtures" (file-name-directory (getenv "NEOVM_FORMS_FILE"))))
  'ok)
(progn
  (setq load-path (cons vm-load-dir load-path))
  'ok)

(load "vm-load-a")
vm-load-a-ran
(require 'vm-load-a)
(eq (car features) 'vm-load-a)

(load "vm-load-lex")
vm-load-lex-lexical
(let ((lexical-binding nil)) (funcall vm-load-lex-fn))

(condition-case err (require 'vm-load-no-provide) (error (car err)))
(condition-case err (require 'vm-load-no-such-file nil t) (error 'bad))
(condition-case err (require 'vm-load-no-such-file) (file-missing (car err)) (error 'other))
